<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KatMovie Hub - Free Movie Downloads</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background: #0a0a0a; color: #fff; font-family: 'Arial', sans-serif; }
        .header { background: linear-gradient(#000, #1a1a1a); padding: 20px; text-align: center; border-bottom: 2px solid #ff0000; }
        .nav-bar { background: #1a1a1a; padding: 10px; }
        .nav-bar a { color: #fff; margin: 0 15px; text-decoration: none; }
        .nav-bar a:hover { color: #ff0000; }
        .search-bar { max-width: 400px; margin: 0 auto; }
        .main-content { padding: 20px; }
        .movie-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
        .movie-card { background: #1e1e1e; border-radius: 8px; overflow: hidden; transition: transform 0.2s; }
        .movie-card:hover { transform: scale(1.02); }
        .movie-poster { width: 100%; height: 300px; object-fit: cover; }
        .movie-info { padding: 15px; }
        .rating { color: #ffd700; }
        .download-btn { background: #ff0000; color: #fff; border: none; padding: 10px 20px; margin: 5px; border-radius: 5px; text-decoration: none; display: inline-block; }
        .download-btn:hover { background: #cc0000; color: #fff; }
        .trailer { margin: 20px 0; position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; }
        .trailer iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0; }
        .movie-detail { background: #1e1e1e; padding: 20px; border-radius: 8px; margin-top: 20px; }
        .footer { background: #000; padding: 10px; text-align: center; margin-top: 40px; color: #ccc; }
        .show-detail { cursor: pointer; color: #ff0000; }
        .loading { text-align: center; color: #ccc; }
        .modal-content { background: #1e1e1e; color: #fff; }
        .modal-header, .modal-footer { border-color: #333; }
        .modal-body { max-height: 70vh; overflow-y: auto; }
        .load-more { text-align: center; margin: 20px 0; }
    </style>
</head>
<body>
    <header class="header">
        <h1><a href="#" style="color: #fff; text-decoration: none;">KatMovie Hub</a></h1>
        <p>Latest HD Movies - Hindi Dubbed & Dual Audio Downloads (480p/720p/1080p)</p>
        <div class="search-bar">
            <input type="text" id="searchInput" class="form-control" placeholder="Search movies..." onkeyup="searchMovies()">
        </div>
    </header>
   
    <nav class="nav-bar">
        <div><a href="#">Home</a> | <a href="#">All Movies</a></div>
    </nav>

    <!-- NEW: Autoplay YouTube Video (replaces old Instagram playlist) -->
    <div class="trailer">
        <iframe 
            src="https://www.youtube.com/embed/lU46B_5Vel4?autoplay=1&mute=1&loop=1&playlist=lU46B_5Vel4&controls=0&rel=0&modestbranding=1&showinfo=0" 
            allow="autoplay; encrypted-media" 
            allowfullscreen>
        </iframe>
    </div>
   
    <div class="container-fluid">
        <div class="row">
            <div class="col-12 main-content">
                <h2>Latest Movies (Hindi Dubbed)</h2>
                <div id="movieGrid" class="movie-grid loading">Loading all posts from WordPress...</div>
                <div id="loadMore" class="load-more" style="display: none;">
                    <button class="btn btn-danger" onclick="loadMorePosts()">Load More Posts</button>
                </div>
               
                <!-- Bootstrap Modal for Details -->
                <div class="modal fade" id="movieModal" tabindex="-1" aria-labelledby="movieModalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-xl">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="movieModalLabel">Movie Details</h5>
                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <div id="modalContent">
                                    <!-- Dynamic content loaded here -->
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
   
    <footer class="footer">
        <p>&copy; 2025 KatMovie Hub. For entertainment only - Use legal sources.</p>
    </footer>
   
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Instagram Embed Script (kept if you use embeds in posts) -->
    <script async defer src="https://www.instagram.com/embed.js"></script>
    <script>
        // Your original script – 100% unchanged
        let currentPage = 1;
        let allPosts = [];
        const PER_PAGE = 100;
        const BASE_URL = 'https://public-api.wordpress.com/rest/v1/sites/katmoviehddotpk.wordpress.com/posts';
       
        function getDownloadLinks(title) {
            return `
                <a href="https://your-shorten-link.com/adfly/480p-${title.replace(/\s+/g, '-').toLowerCase()}" class="download-btn" target="_blank">480p (300MB)</a>
                <a href="https://your-shorten-link.com/shorte/720p-${title.replace(/\s+/g, '-').toLowerCase()}" class="download-btn" target="_blank">720p (800MB)</a>
                <a href="https://your-shorten-link.com/bitly/1080p-${title.replace(/\s+/g, '-').toLowerCase()}" class="download-btn" target="_blank">1080p (1.5GB)</a>
            `;
        }
       
        async function fetchPage(page) {
            try {
                const url = `${BASE_URL}?number=${PER_PAGE}&page=${page}`;
                const response = await fetch(url);
                const data = await response.json();
                const posts = data.posts || [];
                return posts;
            } catch (error) {
                console.error('API fetch failed:', error);
                return [];
            }
        }
       
        async function loadMovies() {
            const posts = await fetchPage(currentPage);
            allPosts = allPosts.concat(posts);
            renderGrid(posts);
            currentPage++;
           
            document.getElementById('loadMore').style.display = posts.length === PER_PAGE ? 'block' : 'none';
           
            if (allPosts.length === 0) {
                document.getElementById('movieGrid').innerHTML = '<p>No posts found. Showing samples...</p>';
                addSampleMovies(document.getElementById('movieGrid'));
            }
        }
       
        function renderGrid(posts) {
            const grid = document.getElementById('movieGrid');
            if (currentPage === 1) {
                grid.innerHTML = '';
            }
           
            posts.forEach(post => {
                const year = new Date(post.date).getFullYear();
                const genres = post.categories ? Object.values(post.categories).map(cat => cat.name || cat.title || cat).join(', ') : 'Uncategorized';
                const synopsis = post.content ? post.content.replace(/<[^>]*>/g, '').substring(0, 100) + '...' : 'No description.';
                const posterUrl = post.attachments && post.attachments.length > 0 ? post.attachments[0].URL : `https://via.placeholder.com/250x350/ff0000/ffffff?text=${encodeURIComponent(post.title)}`;
               
                const card = document.createElement('div');
                card.className = 'movie-card';
                card.setAttribute('data-title', post.title.toLowerCase());
                card.innerHTML = `
                    <img src="${posterUrl}" alt="${post.title} Poster" class="movie-poster" onerror="this.src='https://via.placeholder.com/250x350/ff0000/ffffff?text=${encodeURIComponent(post.title)}'">
                    <div class="movie-info">
                        <h5>${post.title} (${year})</h5>
                        <p class="rating">7.0</p>
                        <p>${genres} | 720p Dual Audio</p>
                        <p>${synopsis}</p>
                        <a href="#" class="btn btn-danger btn-sm show-detail" onclick="showDetail(${post.ID}, '${post.title.replace(/'/g, "\\'")}')">Watch/Download</a>
                    </div>
                `;
                grid.appendChild(card);
            });
        }
       
        async function loadMorePosts() {
            const posts = await fetchPage(currentPage);
            if (posts.length > 0) {
                allPosts = allPosts.concat(posts);
                renderGrid(posts);
                currentPage++;
                document.getElementById('loadMore').style.display = posts.length === PER_PAGE ? 'block' : 'none';
            } else {
                document.getElementById('loadMore').style.display = 'none';
            }
        }
       
        function addSampleMovies(grid) {
            // your original sample code
        }
       
        async function showDetail(postId, title) {
            // your original showDetail function – unchanged
            try {
                const detailResponse = await fetch(`${BASE_URL}/${postId}`);
                const post = await detailResponse.json();
                const fullContent = post.content ? post.content : '<p>No content available.</p>';
                const year = new Date(post.date).getFullYear();
                const genres = post.categories ? Object.values(post.categories).map(cat => cat.name || cat.title || cat).join(', ') : 'Uncategorized';
                const posterUrl = post.attachments && post.attachments.length > 0 ? post.attachments[0].URL : `https://via.placeholder.com/300x450/ff0000/ffffff?text=${encodeURIComponent(title)}`;
               
                document.getElementById('movieModalLabel').textContent = `${title} (${year})`;
                document.getElementById('modalContent').innerHTML = `
                    <img src="${posterUrl}" alt="${title} Poster" style="float: left; margin-right: 20px; border-radius: 8px; max-width: 300px;" onerror="this.src='https://via.placeholder.com/300x450/ff0000/ffffff?text=${encodeURIComponent(title)}'">
                    <div>${fullContent}</div>
                `;
               
                if (window.instgrm && window.instgrm.Embeds) {
                    window.instgrm.Embeds.process(document.getElementById('modalContent'));
                }
               
                const modal = new bootstrap.Modal(document.getElementById('movieModal'));
                modal.show();
            } catch (error) {
                alert('Failed to load details: ' + error.message);
            }
        }
       
        function searchMovies() {
            let input = document.getElementById('searchInput').value.toLowerCase();
            let cards = document.querySelectorAll('.movie-card');
            cards.forEach(card => {
                let title = card.getAttribute('data-title');
                card.style.display = title.includes(input) ? 'block' : 'none';
            });
        }
       
        document.addEventListener('DOMContentLoaded', loadMovies);
    </script>
</body>
</html>